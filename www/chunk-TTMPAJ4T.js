import{d as X,f as Z,g as ee,i as te,k as ne,l as oe,q as ie,s as re,v as b,w as ae}from"./chunk-FSFO6RXW.js";import{a as R}from"./chunk-HGH6A3ZY.js";import{a as se}from"./chunk-BJCE6GIO.js";import"./chunk-ELOAIK2V.js";import"./chunk-QUJFQN2Y.js";import"./chunk-VR5KVVOC.js";import"./chunk-3Q5GMNK6.js";import"./chunk-RS5YQJWL.js";import"./chunk-JROSCJGS.js";import"./chunk-OK2I7K27.js";import"./chunk-4CFH7RX6.js";import"./chunk-7FY2OE2O.js";import"./chunk-2QSXEBB7.js";import"./chunk-TTVFM5DY.js";import"./chunk-EZWARTTP.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-HLX4SABQ.js";import"./chunk-CKP3SGE2.js";import"./chunk-OVQHLAQL.js";import{A as m,Ab as V,Bb as q,Db as K,E as v,Fb as Q,J as S,Ja as z,K as k,L as w,La as B,M as d,N as a,O as r,P as l,Sa as U,U as h,V as E,da as s,ea as y,ga as T,h as j,ha as D,ia as F,k as O,nb as H,ob as A,qa as N,qb as L,ta as M,u as P,v as c,vb as W,wa as $,xb as Y,y as p,yb as G,zb as J}from"./chunk-GZNI7DYC.js";import"./chunk-447CKG3T.js";import"./chunk-CDZFCBFW.js";import"./chunk-E2CLONXR.js";import"./chunk-KRDHHS7Z.js";import"./chunk-JVTPOORY.js";import"./chunk-CLDSZD2A.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-LRFGNCHE.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{e as I}from"./chunk-JHI3MBHO.js";var ce=(()=>{let e=class e{constructor(){}ngOnInit(){}};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=m({type:e,selectors:[["app-header-messages"]],decls:6,vars:0,consts:[[1,"header-messages"],[1,"header-content"],[1,"title"],["name","person-circle-outline",1,"profile-icon"]],template:function(n,i){n&1&&(a(0,"ion-header",0)(1,"ion-toolbar")(2,"div",1)(3,"span",2),s(4,"MENSAJES"),r(),l(5,"ion-icon",3),r()()())},dependencies:[Y,Q,K],styles:[".header-messages[_ngcontent-%COMP%]{--background: #ffffff;--border-color: transparent;box-shadow:0 2px 4px #0000001a}.header-messages[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: #ffffff;--padding-start: 16px;--padding-end: 16px;min-height:56px}.header-messages[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%}.header-messages[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:700;font-size:16px;color:#000;letter-spacing:.5px}.header-messages[_ngcontent-%COMP%]   .profile-icon[_ngcontent-%COMP%]{font-size:28px;color:#000}"]});let o=e;return o})();var _=(()=>{let e=class e{constructor(){this.http=O($)}obtenerMensajes(){return this.http.get("/api/messages/all")}obtenerMensajesPorId(t){return this.http.get(`/api/messages/by_id/${t}`)}obtenerMensajesPorUsuario(t){return this.http.get(`/api/messages/${t}`)}crearMensaje(t){return this.http.post("/api/messages/create",t)}actualizarMensaje(t,n){return this.http.put(`/api/messages/update/${t}`,n)}eliminarMensaje(t){return this.http.delete(`/api/messages/delete/${t}`)}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let o=e;return o})();var me=(()=>{let e=class e{constructor(t,n,i){this.modalCtrl=t,this.messageService=n,this.userService=i,this.user=null,this.nuevoMensaje=""}ngOnInit(){this.userSub=this.userService.currentUser$.subscribe(t=>{this.user=t,t?console.log("Usuario cargado:",t.full_name):console.log("No hay usuario logueado")})}ngOnDestroy(){this.userSub?.unsubscribe()}cerrar(){this.modalCtrl.dismiss()}publicar(){if(!this.user){console.error("No hay usuario logueado, no se puede publicar");return}if(this.nuevoMensaje.trim()){let t=new Date,n=String(t.getDate()).padStart(2,"0"),i=String(t.getMonth()+1).padStart(2,"0"),f=t.getFullYear(),u={content:this.nuevoMensaje.trim(),send_date:`${n}-${i}-${f}`,user:{id:this.user.id}};this.messageService.crearMensaje(u).subscribe({next:x=>this.modalCtrl.dismiss(x),error:x=>console.error("Error al publicar mensaje",x)})}}};e.\u0275fac=function(n){return new(n||e)(p(b),p(_),p(se))},e.\u0275cmp=m({type:e,selectors:[["app-message-modal"]],decls:11,vars:1,consts:[["slot","end"],[3,"click"],[1,"ion-padding"],["placeholder","Escribe tu mensaje...",2,"color","black",3,"ngModelChange","ngModel"],["expand","block",1,"ion-margin-top",3,"click"]],template:function(n,i){n&1&&(a(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),s(3,"Publicar mensaje"),r(),a(4,"ion-buttons",0)(5,"ion-button",1),h("click",function(){return i.cerrar()}),s(6,"Cerrar"),r()()()(),a(7,"ion-content",2)(8,"ion-input",3),F("ngModelChange",function(u){return D(i.nuevoMensaje,u)||(i.nuevoMensaje=u),u}),r(),a(9,"ion-button",4),h("click",function(){return i.publicar()}),s(10,"Publicar"),r()()),n&2&&(c(8),T("ngModel",i.nuevoMensaje))},dependencies:[ae,Z,ee,te,ne,oe,ie,re,X,U,z,B],styles:[".message-title[_ngcontent-%COMP%]{width:90%;background:#0000008c;text-align:center;padding:.6rem 1rem;border-radius:50px;-webkit-backdrop-filter:blur(3px);backdrop-filter:blur(3px);box-shadow:0 2px 6px #0000004d;margin:10% auto 10px}"]});let o=e;return o})();function ge(o,e){o&1&&l(0,"ion-spinner",4)}function fe(o,e){if(o&1&&(a(0,"ion-card",6)(1,"ion-item",7)(2,"ion-avatar",8),l(3,"img",9),r(),a(4,"ion-label")(5,"h2"),s(6),r(),a(7,"p"),s(8),r()()()()),o&2){let g=e.$implicit;c(3),d("src",g.user.photo?g.user.photo:"assets/default-avatar.jpg",P),c(3),y(g.user.full_name),c(2),y(g.content)}}function ue(o,e){if(o&1&&(a(0,"ion-list",5),k(1,fe,9,3,"ion-card",6,S),r()),o&2){let g=E();c(),w(g.mensajes)}}function he(o,e){o&1&&(a(0,"div",10),s(1,` No hay notificaciones
`),r())}var pe=(()=>{let e=class e{constructor(t,n){this.modalCtrl=t,this.messageService=n,this.mensajes=[],this.loading=!0}ngOnInit(){this.cargarMensajes()}cargarMensajes(){this.loading=!0,this.messageService.obtenerMensajes().subscribe({next:t=>{this.mensajes=t,this.loading=!1},error:t=>{console.error("Error cargando mensajes",t),this.loading=!1}})}abrirModal(){return I(this,null,function*(){let t=yield this.modalCtrl.create({component:me});t.onDidDismiss().then(n=>{n.data&&this.cargarMensajes()}),yield t.present()})}};e.\u0275fac=function(n){return new(n||e)(p(b),p(_))},e.\u0275cmp=m({type:e,selectors:[["app-message"]],decls:5,vars:3,consts:[["name","crescent","style","display:block; margin:50% auto;",4,"ngIf"],["class","list-notifications",4,"ngIf"],["color","primary",1,"buttom-comment",3,"click"],["style","text-align:center; color:#555; margin-top:20px;",4,"ngIf"],["name","crescent",2,"display","block","margin","50% auto"],[1,"list-notifications"],[1,"notif-card"],["lines","none"],["slot","start"],["alt","",3,"src"],[2,"text-align","center","color","#555","margin-top","20px"]],template:function(n,i){n&1&&(v(0,ge,1,0,"ion-spinner",0)(1,ue,3,0,"ion-list",1),a(2,"ion-button",2),h("click",function(){return i.abrirModal()}),s(3,` Escribir
`),r(),v(4,he,2,0,"div",3)),n&2&&(d("ngIf",i.loading),c(),d("ngIf",!i.loading&&i.mensajes.length),c(3),d("ngIf",!i.loading&&!i.mensajes.length))},dependencies:[M,N,V,L,G,H,J,q,A],styles:[".notif-card[_ngcontent-%COMP%]{--background: #e6f0ff;border-radius:14px;margin:8px 0;padding:8px;box-shadow:0 3px 6px #007aff33;animation:_ngcontent-%COMP%_fadeInNotif .5s ease forwards}.notif-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: transparent}.notif-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:700;color:#007aff;margin-bottom:3px}.notif-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#333;font-size:14px}.notif-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:50%;object-fit:cover;border:2px solid #007aff}.list-notifications[_ngcontent-%COMP%]{background:transparent;padding:0 5%;margin-bottom:10%}@keyframes _ngcontent-%COMP%_fadeInNotif{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.buttom-comment[_ngcontent-%COMP%]{display:flex;max-width:50%;margin:5% auto 20%}"]});let o=e;return o})();var He=(()=>{let e=class e{constructor(){}ngOnInit(){}};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=m({type:e,selectors:[["app-messages"]],decls:7,vars:1,consts:[[3,"fullscreen"],[1,"message-title"]],template:function(n,i){n&1&&(l(0,"app-header-messages"),a(1,"ion-content",0)(2,"div",1)(3,"h2"),s(4,"Mensajes Generales"),r()(),l(5,"app-message"),r(),l(6,"app-footer-menu")),n&2&&(c(),d("fullscreen",!0))},dependencies:[M,W,R,ce,pe],styles:[".message-title[_ngcontent-%COMP%]{width:90%;background:#00000059;color:#fff;text-align:center;padding:.3rem .8rem;border-radius:20px;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);box-shadow:0 1px 3px #00000040;margin:20px auto;font-size:.75rem;font-weight:500;letter-spacing:.3px}"]});let o=e;return o})();export{He as MessagesPage};
