import{a as ie,b as _}from"./chunk-DJP6UEQN.js";import{d as re,e as ae,f as $,g as se,h as ce,i as le,k as me,l as de,m as pe,n as ue,o as ge,q as fe,s as he,u as ve,v as D,w as x}from"./chunk-FSFO6RXW.js";import{a as oe}from"./chunk-HGH6A3ZY.js";import{a as Ce}from"./chunk-BJCE6GIO.js";import"./chunk-ELOAIK2V.js";import"./chunk-QUJFQN2Y.js";import"./chunk-VR5KVVOC.js";import"./chunk-3Q5GMNK6.js";import"./chunk-RS5YQJWL.js";import"./chunk-JROSCJGS.js";import"./chunk-OK2I7K27.js";import"./chunk-4CFH7RX6.js";import"./chunk-7FY2OE2O.js";import"./chunk-2QSXEBB7.js";import"./chunk-TTVFM5DY.js";import"./chunk-EZWARTTP.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-HLX4SABQ.js";import"./chunk-CKP3SGE2.js";import"./chunk-OVQHLAQL.js";import{A as u,Ba as W,E as S,H as U,I as z,Ja as q,La as G,M as f,N as a,O as r,P as p,Sa as K,T,U as g,V as h,aa as V,ca as A,da as s,ea as v,fa as N,ga as B,h as w,ha as H,ia as Y,k as O,m as y,ma as L,n as P,ob as J,pa as F,qa as R,qb as Q,rb as X,sb as Z,ta as b,tb as ee,u as k,ub as te,v as c,vb as ne,wa as j,y as l}from"./chunk-GZNI7DYC.js";import"./chunk-447CKG3T.js";import"./chunk-CDZFCBFW.js";import"./chunk-E2CLONXR.js";import"./chunk-KRDHHS7Z.js";import"./chunk-JVTPOORY.js";import"./chunk-CLDSZD2A.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-LRFGNCHE.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{e as E}from"./chunk-JHI3MBHO.js";var be=(()=>{let t=class t{constructor(){this.http=O(j)}obtenerImagenes(){return this.http.get("/api/images/all")}obtenerImagenPorId(e){return this.http.get(`/api/images/by_id/${e}`)}obtenerImagenesPorEvento(e){return this.http.get(`/api/images/by_event/${e}`)}crearImagen(e){return this.http.post("/api/images/create",e)}actualizarImagen(e,n){return this.http.put(`/api/images/update/${e}`,n)}eliminarImagen(e){return this.http.delete(`/api/images/delete/${e}`)}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=w({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})();function Fe(i,t){if(i&1&&(a(0,"div",5),p(1,"img",6),r()),i&2){let m=t.$implicit,e=t.index,n=h(2);A("active",e===n.currentIndex),c(),f("src",m.image,k)("alt",m.title)}}function je(i,t){if(i&1){let m=T();S(0,Fe,2,4,"div",2),a(1,"button",3),g("click",function(){y(m);let n=h();return P(n.prev())}),s(2,"\u276E"),r(),a(3,"button",4),g("click",function(){y(m);let n=h();return P(n.next())}),s(4,"\u276F"),r()}if(i&2){let m=h();f("ngForOf",m.slides)}}function $e(i,t){i&1&&(a(0,"div",1),s(1," No hay im\xE1genes disponibles para mostrar de momento :). "),r())}var _e=(()=>{let t=class t{constructor(e,n,o){this.router=e,this.imageService=n,this.eventService=o,this.slides=[],this.currentIndex=0}ngOnInit(){let e=this.eventService.getEventoActual();e&&this.loadImagesForEvent(e.id)}loadImagesForEvent(e){this.imageService.obtenerImagenesPorEvento(e).subscribe({next:n=>{this.slides=n.map(o=>({image:o.src,title:o.description||"Sin descripci\xF3n",description:o.description||"Sin descripci\xF3n"}))},error:n=>console.error("Error al cargar las im\xE1genes",n)})}next(){this.slides.length&&(this.currentIndex=(this.currentIndex+1)%this.slides.length)}prev(){this.slides.length&&(this.currentIndex=(this.currentIndex-1+this.slides.length)%this.slides.length)}};t.\u0275fac=function(n){return new(n||t)(l(W),l(be),l(_))},t.\u0275cmp=u({type:t,selectors:[["app-carousel-images"]],decls:3,vars:1,consts:[[1,"carousel-container-0",2,"position","relative","overflow","hidden","max-width","100%","border-radius","8px","box-shadow","0 4px 8px rgba(0, 0, 0, 0.1)"],[2,"background-color","rgba(0, 0, 0, 0.65)","padding","30px","text-align","center","color","white","font-size","1rem","font-weight","500","border-radius","8px","min-height","250px","display","flex","justify-content","center","flex-direction","column","align-items","center","margin","0 auto","max-width","80%","box-sizing","border-box"],["class","carousel-slide","style","display: none; transition: opacity 0.5s ease-in-out;",3,"active",4,"ngFor","ngForOf"],[1,"carousel-control-0","prev",2,"position","absolute","top","50%","transform","translateY(-50%)","left","10px","background","rgba(0, 0, 0, 0.5)","color","white","border","none","padding","10px 15px","cursor","pointer","border-radius","50%","z-index","10","font-size","1.5rem",3,"click"],[1,"carousel-control-0","next",2,"position","absolute","top","50%","transform","translateY(-50%)","right","10px","background","rgba(0, 0, 0, 0.5)","color","white","border","none","padding","10px 15px","cursor","pointer","border-radius","50%","z-index","10","font-size","1.5rem",3,"click"],[1,"carousel-slide",2,"display","none","transition","opacity 0.5s ease-in-out"],[2,"width","100%","height","auto","display","block","object-fit","cover","border-radius","8px",3,"src","alt"]],template:function(n,o){n&1&&(a(0,"div",0),U(1,je,5,1)(2,$e,2,0,"div",1),r()),n&2&&(c(),z(o.slides.length>0?1:2))},dependencies:[x,b,F],styles:[".carousel-container-0[_ngcontent-%COMP%]{position:relative;width:100%;max-width:500px;margin:20px auto;overflow:hidden;border-radius:10px}.carousel-slide[_ngcontent-%COMP%]{display:none;text-align:center}.carousel-slide[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:90%;height:80%;object-fit:cover;border-radius:20%}.carousel-slide.active[_ngcontent-%COMP%]{display:block}.carousel-slide[_ngcontent-%COMP%]   .carousel-caption[_ngcontent-%COMP%]{margin-top:10px;color:#333}.carousel-control-0[_ngcontent-%COMP%]{position:absolute;top:50%;transform:translateY(-50%);background-color:#0000004d;color:#fff;border:none;padding:10px;cursor:pointer;border-radius:50%;z-index:10}.carousel-control-0.prev[_ngcontent-%COMP%]{left:10px}.carousel-control-0.next[_ngcontent-%COMP%]{right:10px}.carousel-button-container[_ngcontent-%COMP%]{width:50%;margin:1rem auto 2rem;text-align:center}.carousel-button[_ngcontent-%COMP%]{border-radius:20%}"]});let i=t;return i})();var Me=(()=>{let t=class t{constructor(e,n){this.alertCtrl=e,this.eventService=n,this.event=null}ngOnInit(){this.event=this.eventService.getEventoActual(),console.log("Evento cargado en descripci\xF3n:",this.event)}ngOnDestroy(){this.eventSub?.unsubscribe()}suscribe(){return E(this,null,function*(){this.event&&(this.event.need_payment?yield(yield this.alertCtrl.create({header:"Pago requerido",message:"Este evento requiere pago. Procede con el pago para inscribirte.",buttons:[{text:"Cancelar",role:"cancel"},{text:"Pagar",handler:()=>this.paymentProcedure()}]})).present():yield(yield this.alertCtrl.create({header:"Inscripci\xF3n completa",message:"Te has inscrito gratis al evento.",buttons:["OK"]})).present())})}paymentProcedure(){console.log("Redirigiendo al pago...")}};t.\u0275fac=function(n){return new(n||t)(l(ve),l(_))},t.\u0275cmp=u({type:t,selectors:[["app-event-description"]],decls:15,vars:4,consts:[[2,"display","flex","justify-content","center"],["color","primary",1,"buttom-event",3,"click"]],template:function(n,o){n&1&&(a(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),s(3),r(),a(4,"ion-card-subtitle"),s(5),r()(),a(6,"ion-card-content")(7,"p"),s(8),r(),p(9,"br"),a(10,"p")(11,"strong",0),s(12),r()()(),a(13,"ion-button",1),g("click",function(){return o.suscribe()}),s(14," Inscribirse "),r()()),n&2&&(c(3),v(o.event==null?null:o.event.title),c(2),v(o.event==null?null:o.event.date),c(3),v(o.event==null?null:o.event.description),c(4),N(" ",o.event!=null&&o.event.need_payment?"Evento de pago":"Gratis"," "))},dependencies:[Q,Z,te,ee,X,J],styles:["ion-card[_ngcontent-%COMP%]{margin:16px;border-radius:12px;background-color:#222a28}ion-card-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700}ion-button[_ngcontent-%COMP%]{margin-right:8px}.buttom-event[_ngcontent-%COMP%]{--background: #64b5f6;--color: white;--border-radius: 20px;display:block;max-width:40%;margin:0 auto 5%}"]});let i=t;return i})();var ye=(()=>{let t=class t{constructor(e){this.modalCtrl=e,this.nuevoComentario=""}cerrar(){this.modalCtrl.dismiss()}publicar(){this.nuevoComentario.trim()&&this.modalCtrl.dismiss(this.nuevoComentario.trim())}};t.\u0275fac=function(n){return new(n||t)(l(D))},t.\u0275cmp=u({type:t,selectors:[["app-comment-modal"]],decls:11,vars:1,consts:[["slot","end"],[3,"click"],[1,"ion-padding"],["placeholder","Escribe tu comentario...",2,"color","black",3,"ngModelChange","ngModel"],["expand","block",1,"ion-margin-top",3,"click"]],template:function(n,o){n&1&&(a(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),s(3,"Publicar comentario"),r(),a(4,"ion-buttons",0)(5,"ion-button",1),g("click",function(){return o.cerrar()}),s(6,"Cerrar"),r()()()(),a(7,"ion-content",2)(8,"ion-input",3),Y("ngModelChange",function(C){return H(o.nuevoComentario,C)||(o.nuevoComentario=C),C}),r(),a(9,"ion-button",4),g("click",function(){return o.publicar()}),s(10,"Publicar"),r()()),n&2&&(c(8),B("ngModel",o.nuevoComentario))},dependencies:[x,$,se,le,me,de,fe,he,re,b,K,q,G],encapsulation:2});let i=t;return i})();var Pe=(()=>{let t=class t{constructor(){this.http=O(j),this.baseUrl="/api/comments"}obtenerComentarios(){return this.http.get(`${this.baseUrl}/all`)}obtenerComentariosPorUsuario(e){return this.http.get(`${this.baseUrl}/by_user/${e}`)}obtenerComentariosPorEvento(e){return this.http.get(`${this.baseUrl}/by_event/${e}`)}obtenerComentarioPorId(e){return this.http.get(`${this.baseUrl}/by_id/${e}`)}crearComentario(e){return this.http.post(`${this.baseUrl}/create`,e)}actualizarComentario(e,n){return this.http.put(`${this.baseUrl}/update/${e}`,n)}eliminarComentario(e){return this.http.delete(`${this.baseUrl}/delete/${e}`)}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=w({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})();function Ue(i,t){if(i&1&&(a(0,"ion-card",5)(1,"ion-item",6)(2,"ion-avatar",7),p(3,"img",8),r(),a(4,"ion-label")(5,"h2"),s(6),r(),a(7,"p"),s(8),r()()()()),i&2){let m=t.$implicit;c(3),f("src",m.profilePic,k),c(3),v(m.username),c(2),v(m.comment)}}function ze(i,t){if(i&1&&(a(0,"ion-list",3),S(1,Ue,9,3,"ion-card",4),r()),i&2){let m=h();c(),f("ngForOf",m.comentariosUI)}}function Ve(i,t){i&1&&(a(0,"div",9),s(1," S\xE9 el primero en comentar "),r())}var Se=(()=>{let t=class t{constructor(e,n,o,d){this.modalCtrl=e,this.commentService=n,this.eventService=o,this.userService=d,this.comentariosUI=[],this.user=null}ngOnInit(){this.userSub=this.userService.currentUser$.subscribe(n=>{this.user=n});let e=this.eventService.getEventoActual();e&&this.cargarComentarios(e.id)}ngOnDestroy(){this.userSub?.unsubscribe()}cargarComentarios(e){this.commentService.obtenerComentariosPorEvento(e).subscribe({next:n=>{this.comentariosUI=n.map(o=>({username:o.user?.full_name||"Usuario",profilePic:o.user?.photo||"assets/profile-placeholder.png",comment:o.description}))},error:n=>console.error("Error al cargar comentarios:",n)})}abrirModal(){return E(this,null,function*(){let e=yield this.modalCtrl.create({component:ye});e.onDidDismiss().then(n=>{if(n.data&&this.user){let o=this.eventService.getEventoActual();if(!o)return;let d=new Date,C=String(d.getDate()).padStart(2,"0"),Ee=String(d.getMonth()+1).padStart(2,"0"),we=d.getFullYear(),Oe={description:n.data,date:`${C}-${Ee}-${we}`,user:{id:this.user.id},event:{id:o.id}};this.commentService.crearComentario(Oe).subscribe({next:M=>{this.comentariosUI.push({username:M.user?.full_name||"T\xFA",profilePic:M.user?.photo||"https://png.pngtree.com/png-vector/20250512/ourmid/pngtree-default-avatar-profile-icon-vector-png-image_16213769.png",comment:M.description})},error:M=>console.error("Error al crear comentario:",M)})}}),yield e.present()})}};t.\u0275fac=function(n){return new(n||t)(l(D),l(Pe),l(_),l(Ce))},t.\u0275cmp=u({type:t,selectors:[["app-comment"]],decls:5,vars:2,consts:[["noComments",""],["class","list-comment",4,"ngIf","ngIfElse"],["color","primary",1,"buttom-comment",3,"click"],[1,"list-comment"],["class","coment-card",4,"ngFor","ngForOf"],[1,"coment-card"],["lines","none"],["slot","start"],["alt","Foto de perfil",3,"src"],[2,"display","flex","justify-content","center","align-items","center","margin","1rem","padding","0.5rem 1rem","background-color","rgba(0,0,0,0.6)","color","white","border-radius","12px","font-size","0.9rem","text-align","center"]],template:function(n,o){if(n&1){let d=T();S(0,ze,2,1,"ion-list",1)(1,Ve,2,0,"ng-template",null,0,L),a(3,"ion-button",2),g("click",function(){return y(d),P(o.abrirModal())}),s(4,` Comentar
`),r()}if(n&2){let d=V(2);f("ngIf",o.comentariosUI.length>0)("ngIfElse",d)}},dependencies:[x,ae,$,ce,pe,ue,ge,b,F,R],styles:[".coment-card[_ngcontent-%COMP%]{--background: #ffffff;border-radius:12px;margin:5px 0;padding:5px}.coment-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: transparent}.coment-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:700;color:#007aff;margin-bottom:2px}.coment-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#555;font-size:14px}.coment-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:50%;object-fit:cover}.list-comment[_ngcontent-%COMP%]{background:transparent;margin-bottom:5%}.buttom-event[_ngcontent-%COMP%]{margin-bottom:50%}.buttom-comment[_ngcontent-%COMP%]{margin:5% auto 10%;display:flex;max-width:50%}"]});let i=t;return i})();var ft=(()=>{let t=class t{constructor(){}ngOnInit(){}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=u({type:t,selectors:[["app-event"]],decls:15,vars:0,consts:[[1,"carousel-header-0"]],template:function(n,o){n&1&&(p(0,"app-header-calendar"),a(1,"ion-content")(2,"div",0)(3,"h2"),s(4,"Im\xE1genes del evento"),r()(),p(5,"app-carousel-images"),a(6,"div",0)(7,"h2"),s(8,"Descripci\xF3n"),r()(),p(9,"app-event-description"),a(10,"div",0)(11,"h2"),s(12,"Comentarios"),r()(),p(13,"app-comment"),r(),p(14,"app-footer-menu"))},dependencies:[ie,ne,oe,_e,Me,Se],styles:[".carousel-header-0[_ngcontent-%COMP%]{width:90%;background:#0000008c;text-align:center;padding:.6rem 1rem;border-radius:50px;-webkit-backdrop-filter:blur(3px);backdrop-filter:blur(3px);box-shadow:0 2px 6px #0000004d;margin:10% auto 10px}.carousel-header-0[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#fff;font-size:1.1rem;font-weight:600;margin:0;letter-spacing:.3px;text-shadow:0 1px 2px rgba(0,0,0,.5)}"]});let i=t;return i})();export{ft as EventPage};
