import{a as W}from"./chunk-HGH6A3ZY.js";import{a as j}from"./chunk-BJCE6GIO.js";import{a as D,c as L,d as R,e as V,g as A,j as B,m as H}from"./chunk-2VS2WOJ6.js";import{A as u,Ab as T,Ba as v,Db as z,Fb as C,Gb as U,Ja as w,La as y,M as d,N as s,O as r,P as l,Sa as x,U as p,da as m,ga as f,ha as _,ia as h,nb as S,ob as I,u as b,v as c,vb as k,xb as E,y as P,yb as F}from"./chunk-GZNI7DYC.js";import"./chunk-447CKG3T.js";import"./chunk-CDZFCBFW.js";import"./chunk-E2CLONXR.js";import"./chunk-KRDHHS7Z.js";import"./chunk-JVTPOORY.js";import"./chunk-CLDSZD2A.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-LRFGNCHE.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{a as M,b as O}from"./chunk-JHI3MBHO.js";var N=(()=>{let o=class o{constructor(){}ngOnInit(){}};o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=u({type:o,selectors:[["app-header-settings"]],decls:6,vars:0,consts:[[1,"header-settings"],[1,"header-content"],[1,"title"],["name","person-circle-outline",1,"profile-icon"]],template:function(n,t){n&1&&(s(0,"ion-header",0)(1,"ion-toolbar")(2,"div",1)(3,"span",2),m(4,"AJUSTES"),r(),l(5,"ion-icon",3),r()()())},dependencies:[E,C,z],styles:[".header-settings[_ngcontent-%COMP%]{--background: #ffffff;--border-color: transparent;box-shadow:0 2px 4px #0000001a}.header-settings[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: #ffffff;--padding-start: 16px;--padding-end: 16px;min-height:56px}.header-settings[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%}.header-settings[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:700;font-size:16px;color:#000;letter-spacing:.5px}.header-settings[_ngcontent-%COMP%]   .profile-icon[_ngcontent-%COMP%]{font-size:28px;color:#000}"]});let g=o;return g})();var ie=(()=>{let o=class o{constructor(e,n){this.userService=e,this.router=n,this.user=null,this.username="",this.email="",this.password="",this.profileImage="assets/default-avatar.jpg",this.showPassword=!1,D({cameraOutline:L,eyeOutline:V,eyeOffOutline:R,saveOutline:B,swapHorizontalOutline:H,logOutOutline:A})}ngOnInit(){this.loadUserData(),this.userService.currentUser$.subscribe(e=>{e&&(this.user=e,this.username=e.full_name,this.email=e.email,this.password=e.password,this.profileImage=e.photo||"assets/default-avatar.jpg")})}loadUserData(){this.user=this.userService.getUsuarioActual(),this.user&&(this.username=this.user.full_name,this.email=this.user.email,this.password=this.user.password,this.profileImage=this.user.photo||"assets/default-avatar.jpg")}togglePasswordVisibility(){this.showPassword=!this.showPassword}changeProfileImage(){let e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=n=>{let t=n.target.files[0];if(t){let a=new FileReader;a.onload=i=>{this.profileImage=i.target.result},a.readAsDataURL(t)}},e.click()}onImageError(e){e.target.src="assets/images/profile-placeholder.png"}saveChanges(){if(!this.user||!this.isFormValid())return;let e=O(M({},this.user),{full_name:this.username,email:this.email,password:this.password,photo:this.profileImage});this.userService.actualizarUsuario(this.user.id,e).subscribe({next:n=>{console.log("Usuario actualizado y sobrescrito:",n)},error:n=>console.error("Error al actualizar usuario:",n)})}logout(){this.userService.logout(),console.log("Cerrando sesi\xF3n"),this.router.navigate(["/login"])}isFormValid(){return this.username.trim().length>0&&this.email.trim().length>0&&this.validateEmail(this.email)}validateEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}};o.\u0275fac=function(n){return new(n||o)(P(j),P(v))},o.\u0275cmp=u({type:o,selectors:[["app-settings"]],decls:30,vars:8,consts:[[3,"fullscreen"],[1,"settings-container"],[1,"user-section"],[1,"avatar-container"],[1,"profile-avatar"],["alt","Foto de perfil",3,"error","src"],["fill","clear","size","small",1,"edit-photo-btn",3,"click"],["name","camera-outline"],[1,"username-item"],["label","Nombre Completo","labelPlacement","stacked","placeholder","Ingresa tu nombre de usuario",1,"username-input",3,"ngModelChange","ngModel"],[1,"section-label"],[1,"settings-list"],[1,"settings-item"],["label","Correo electr\xF3nico","labelPlacement","stacked","type","email","placeholder","tu@email.com",1,"email-input",3,"ngModelChange","ngModel"],[1,"divider"],["label","Contrase\xF1a","labelPlacement","stacked","placeholder","Ingresa tu contrase\xF1a",1,"password-input",3,"ngModelChange","type","ngModel"],["fill","clear","slot","end",1,"toggle-password-btn",3,"click"],[3,"name"],[1,"action-buttons"],["expand","block",1,"save-button",3,"click","disabled"],["name","save-outline","slot","start"],["expand","block","fill","clear",1,"logout-button",3,"click"],["name","log-out-outline","slot","start"]],template:function(n,t){n&1&&(l(0,"app-header-settings"),s(1,"ion-content",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"ion-avatar",4)(6,"img",5),p("error",function(i){return t.onImageError(i)}),r()(),s(7,"ion-button",6),p("click",function(){return t.changeProfileImage()}),l(8,"ion-icon",7),r()(),s(9,"ion-item",8)(10,"ion-input",9),h("ngModelChange",function(i){return _(t.username,i)||(t.username=i),i}),r()(),s(11,"p",10),m(12,"Foto de perfil"),r()(),s(13,"ion-list",11)(14,"ion-item",12)(15,"ion-input",13),h("ngModelChange",function(i){return _(t.email,i)||(t.email=i),i}),r()()(),l(16,"div",14),s(17,"ion-list",11)(18,"ion-item",12)(19,"ion-input",15),h("ngModelChange",function(i){return _(t.password,i)||(t.password=i),i}),r(),s(20,"ion-button",16),p("click",function(){return t.togglePasswordVisibility()}),l(21,"ion-icon",17),r()()(),s(22,"div",18)(23,"ion-button",19),p("click",function(){return t.saveChanges()}),l(24,"ion-icon",20),m(25," Guardar Cambios "),r(),s(26,"ion-button",21),p("click",function(){return t.logout()}),l(27,"ion-icon",22),m(28," Cerrar Sesi\xF3n "),r()()()(),l(29,"app-footer-menu")),n&2&&(c(),d("fullscreen",!0),c(5),d("src",t.profileImage,b),c(4),f("ngModel",t.username),c(5),f("ngModel",t.email),c(4),d("type",t.showPassword?"text":"password"),f("ngModel",t.password),c(2),d("name",t.showPassword?"eye-off-outline":"eye-outline"),c(2),d("disabled",!t.isFormValid()))},dependencies:[k,S,I,C,T,F,U,x,w,y,N,W],styles:[".strength-bar[_ngcontent-%COMP%]{height:100%;width:0%;background:linear-gradient(to right,red,#ff0,green);transition:width .3s ease-in-out;z-index:11}.settings-container[_ngcontent-%COMP%]{padding:16px}.settings-container[_ngcontent-%COMP%]   .user-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-bottom:24px}.settings-container[_ngcontent-%COMP%]   .user-section[_ngcontent-%COMP%]   .avatar-container[_ngcontent-%COMP%]{position:relative;margin-bottom:12px}.settings-container[_ngcontent-%COMP%]   .user-section[_ngcontent-%COMP%]   .avatar-container[_ngcontent-%COMP%]   .profile-avatar[_ngcontent-%COMP%]{width:100px;height:100px;border-radius:50%;overflow:hidden;border:2px solid #3880ff}.settings-container[_ngcontent-%COMP%]   .user-section[_ngcontent-%COMP%]   .avatar-container[_ngcontent-%COMP%]   .profile-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.settings-container[_ngcontent-%COMP%]   .user-section[_ngcontent-%COMP%]   .avatar-container[_ngcontent-%COMP%]   .edit-photo-btn[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0;background-color:#ffffffe6;border-radius:50%;width:36px;height:36px;display:flex;align-items:center;justify-content:center}.settings-container[_ngcontent-%COMP%]   .user-section[_ngcontent-%COMP%]   .avatar-container[_ngcontent-%COMP%]   .edit-photo-btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;color:#3880ff}.settings-container[_ngcontent-%COMP%]   .user-section[_ngcontent-%COMP%]   .username-item[_ngcontent-%COMP%]{background-color:transparent;width:110%;margin-bottom:8px}.settings-container[_ngcontent-%COMP%]   .user-section[_ngcontent-%COMP%]   .username-item[_ngcontent-%COMP%]   .username-input[_ngcontent-%COMP%]{border-radius:8px;padding:8px 12px;color:#222428}.settings-container[_ngcontent-%COMP%]   .user-section[_ngcontent-%COMP%]   .section-label[_ngcontent-%COMP%]{margin-top:4px;font-size:14px;color:#92949c;text-align:center}.settings-container[_ngcontent-%COMP%]   .settings-list[_ngcontent-%COMP%]{background-color:transparent;margin-bottom:16px}.settings-container[_ngcontent-%COMP%]   .settings-list[_ngcontent-%COMP%]   .settings-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0}.settings-container[_ngcontent-%COMP%]   .settings-list[_ngcontent-%COMP%]   .settings-item[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{width:100%;border-radius:8px;padding:8px 12px;color:#222428}.settings-container[_ngcontent-%COMP%]   .settings-list[_ngcontent-%COMP%]   .settings-item[_ngcontent-%COMP%]   .toggle-password-btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#3880ff}.settings-container[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{height:1px;margin:16px 0}.settings-container[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.settings-container[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]{background-color:#3880ff;color:#fff;border-radius:8px}.settings-container[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:6px}.settings-container[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .logout-button[_ngcontent-%COMP%]{color:#3880ff;border:1px solid #3880ff;border-radius:8px}.settings-container[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .logout-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:6px}"]});let g=o;return g})();export{ie as SettingsPage};
